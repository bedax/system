#!/bin/sh


screenshot_path="$HOME/screenshot-$(date +%y-%m-%d--%H-%M-%S).png"

screenshot_full() {
   maim --hidecursor "$screenshot_path"
}

screenshot_window() {
   maim --hidecursor "$screenshot_path" \
        --windowid="$(xdotool getactivewindow)"
}

screenshot() {
   if [ "$1" = "full" ]; then
      screenshot_full
   else
      screenshot_window
   fi;
}

copy_screenshot() {
   xclip -selection clipboard -target image/png -in "$screenshot_path"
   rm -f "$screenshot_path"
}

notify_success() {
   notify-send.py \
      --urgency low \
      --replaces-process confirmation \
      "screenshot copied" &
}

notify_failure() {
   notify-send.py \
      --urgency critical \
      --replaces-process confirmation \
      "failed to copy the screenshot" &
}


(screenshot "$1" && copy_screenshot && notify_success) || notify_failure
