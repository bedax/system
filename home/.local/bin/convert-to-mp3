#!/usr/bin/env python3

import os
import subprocess
import sys



if len(sys.argv) < 2:
    print("usage: {} [--dry] [file(s)]".format(sys.argv[0]))
    sys.exit(1)


try:
    sys.argv.remove("--dry")
except ValueError:
    dry = False
else:
    dry = True


for input_path in sys.argv[1:]:
    input_path_without_extension = os.path.splitext(input_path)[0]
    output_path = "{}.mp3".format(input_path_without_extension)

    subprocess.call([
        "echo" if dry else "ffmpeg",
        "-y",
        "-i", input_path,
        "-codec:a", "libmp3lame",
        "-q:a", "0",
        "-map_metadata", "0",
        "-id3v2_version", "3",
        output_path
    ])
